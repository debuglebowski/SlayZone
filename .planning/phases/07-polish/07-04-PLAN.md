---
phase: 07-polish
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/src/components/onboarding/OnboardingDialog.tsx
  - src/renderer/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "First launch shows onboarding modal"
    - "User can navigate through onboarding steps"
    - "Completing onboarding marks it done (never shows again)"
    - "Skipping onboarding also marks it done"
  artifacts:
    - path: "src/renderer/src/components/onboarding/OnboardingDialog.tsx"
      provides: "Onboarding modal carousel"
      exports: ["OnboardingDialog"]
    - path: "src/renderer/src/App.tsx"
      provides: "OnboardingDialog rendered"
      contains: "OnboardingDialog"
  key_links:
    - from: "OnboardingDialog.tsx"
      to: "window.api.settings"
      via: "get/set onboarding_completed"
      pattern: "settings\\.(get|set)"
---

<objective>
Add first-launch onboarding flow

Purpose: Complete UX-04 - welcome new users and explain key features
Output: Modal carousel on first launch explaining Focus features
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-polish/07-RESEARCH.md
@src/renderer/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OnboardingDialog component</name>
  <files>src/renderer/src/components/onboarding/OnboardingDialog.tsx</files>
  <action>
Create onboarding carousel using existing Dialog pattern:

```typescript
import { useState, useEffect } from 'react'
import { Dialog, DialogContent } from '@/components/ui/dialog'
import { Button } from '@/components/ui/button'
import { cn } from '@/lib/utils'

interface OnboardingStep {
  title: string
  description: string
}

const ONBOARDING_STEPS: OnboardingStep[] = [
  {
    title: 'Welcome to Focus',
    description: 'A simple task manager with a focused Work Mode to help you get things done without rabbit-holing.'
  },
  {
    title: 'Organize with Projects',
    description: 'Create projects in the sidebar to group related tasks. Click "All" to see tasks across all projects.'
  },
  {
    title: 'Work Mode',
    description: 'Open a task and click "Work Mode" for a dedicated workspace with AI chat, browser tabs, and documents.'
  },
  {
    title: 'Keyboard Shortcuts',
    description: 'Press "n" to create a new task from anywhere. Press "esc" to go back.'
  }
]

export function OnboardingDialog(): React.JSX.Element | null {
  const [open, setOpen] = useState(false)
  const [step, setStep] = useState(0)

  useEffect(() => {
    // Check if onboarding already completed
    window.api.settings.get('onboarding_completed').then(value => {
      if (value !== 'true') {
        setOpen(true)
      }
    })
  }, [])

  const handleNext = (): void => {
    if (step < ONBOARDING_STEPS.length - 1) {
      setStep(step + 1)
    } else {
      completeOnboarding()
    }
  }

  const handleSkip = (): void => {
    completeOnboarding()
  }

  const completeOnboarding = (): void => {
    window.api.settings.set('onboarding_completed', 'true')
    setOpen(false)
  }

  if (!open) return null

  const current = ONBOARDING_STEPS[step]

  return (
    <Dialog open={open} onOpenChange={() => {}}>
      <DialogContent className="sm:max-w-md" hideCloseButton>
        <div className="text-center py-6">
          <h2 className="text-xl font-bold mb-3">{current.title}</h2>
          <p className="text-muted-foreground mb-8 px-4">{current.description}</p>

          {/* Step indicators */}
          <div className="flex justify-center gap-2 mb-6">
            {ONBOARDING_STEPS.map((_, i) => (
              <div
                key={i}
                className={cn(
                  'w-2 h-2 rounded-full transition-colors',
                  i === step ? 'bg-primary' : 'bg-muted'
                )}
              />
            ))}
          </div>

          {/* Actions */}
          <div className="flex justify-center gap-3">
            {step < ONBOARDING_STEPS.length - 1 && (
              <Button variant="ghost" onClick={handleSkip}>
                Skip
              </Button>
            )}
            <Button onClick={handleNext}>
              {step < ONBOARDING_STEPS.length - 1 ? 'Next' : 'Get Started'}
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  )
}
```

Note: Use `hideCloseButton` prop or handle via DialogContent - check if shadcn Dialog supports it, otherwise omit close button manually or accept default behavior.
  </action>
  <verify>`npm run typecheck` passes</verify>
  <done>OnboardingDialog component created</done>
</task>

<task type="auto">
  <name>Task 2: Integrate onboarding in App.tsx</name>
  <files>src/renderer/src/App.tsx</files>
  <action>
Add OnboardingDialog to App:

1. Import: `import { OnboardingDialog } from '@/components/onboarding/OnboardingDialog'`

2. Add at the END of the kanban view return (inside SidebarProvider, after UserSettingsDialog):
```tsx
{/* Onboarding (first launch) */}
<OnboardingDialog />
```

This ensures onboarding shows on first launch when user reaches kanban view.
  </action>
  <verify>
1. Delete `onboarding_completed` from settings (or use fresh db)
2. Launch app -> onboarding modal appears
3. Click through steps -> modal closes
4. Relaunch app -> no onboarding (already completed)
  </verify>
  <done>Onboarding shows on first launch only</done>
</task>

</tasks>

<verification>
- [ ] `npm run typecheck` passes
- [ ] First launch shows onboarding
- [ ] Can navigate through all 4 steps
- [ ] "Skip" closes and marks complete
- [ ] "Get Started" closes and marks complete
- [ ] Second launch does NOT show onboarding
</verification>

<success_criteria>
First-run onboarding educates new users and only shows once.
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish/07-04-SUMMARY.md`
</output>
