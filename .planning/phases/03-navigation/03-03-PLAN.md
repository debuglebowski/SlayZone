---
phase: 03-navigation
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/renderer/src/components/sidebar/AppSidebar.tsx
  - src/renderer/src/components/sidebar/ProjectItem.tsx
  - src/renderer/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar visible on left with project blobs"
    - "Each blob shows 2-letter abbreviation on colored background"
    - "'All' button shows all tasks across projects"
    - "Click project blob filters to that project"
    - "Selected project has ring indicator"
  artifacts:
    - path: "src/renderer/src/components/sidebar/AppSidebar.tsx"
      provides: "Main sidebar wrapper"
      contains: "SidebarProvider"
    - path: "src/renderer/src/components/sidebar/ProjectItem.tsx"
      provides: "Project blob component"
      contains: "rounded-lg"
    - path: "src/renderer/src/App.tsx"
      provides: "Updated layout with sidebar"
      contains: "AppSidebar"
  key_links:
    - from: "src/renderer/src/App.tsx"
      to: "src/renderer/src/components/sidebar/AppSidebar.tsx"
      via: "import + render"
      pattern: "import.*AppSidebar"
    - from: "src/renderer/src/components/sidebar/AppSidebar.tsx"
      to: "src/renderer/src/components/ui/sidebar.tsx"
      via: "shadcn sidebar"
      pattern: "from.*@/components/ui/sidebar"
---

<objective>
Build sidebar UI with project blobs and "All" view. Refactor App.tsx to use sidebar layout.

Purpose: Primary navigation for project switching
Output: Working sidebar with project selection and "All" view
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-navigation/03-RESEARCH.md
@src/renderer/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProjectItem blob component</name>
  <files>src/renderer/src/components/sidebar/ProjectItem.tsx</files>
  <action>
Create directory and file `src/renderer/src/components/sidebar/ProjectItem.tsx`:

```tsx
import { cn } from "@/lib/utils"
import type { Project } from "../../../../shared/types/database"

interface ProjectItemProps {
  project: Project
  selected: boolean
  onClick: () => void
}

export function ProjectItem({ project, selected, onClick }: ProjectItemProps) {
  const abbrev = project.name.slice(0, 2).toUpperCase()

  return (
    <button
      onClick={onClick}
      className={cn(
        "w-10 h-10 rounded-lg flex items-center justify-center",
        "text-xs font-semibold text-white transition-all",
        "hover:scale-105",
        selected && "ring-2 ring-primary ring-offset-2 ring-offset-background"
      )}
      style={{ backgroundColor: project.color }}
      title={project.name}
    >
      {abbrev}
    </button>
  )
}
```

2-letter abbreviation from first two chars. Ring shows selection. Title for accessibility.
  </action>
  <verify>File exists with exported ProjectItem component.</verify>
  <done>ProjectItem blob component created</done>
</task>

<task type="auto">
  <name>Task 2: Create AppSidebar with projects + All</name>
  <files>src/renderer/src/components/sidebar/AppSidebar.tsx</files>
  <action>
Create `src/renderer/src/components/sidebar/AppSidebar.tsx`:

```tsx
import {
  Sidebar,
  SidebarContent,
  SidebarGroup,
  SidebarGroupContent,
  SidebarMenu,
  SidebarMenuItem,
} from "@/components/ui/sidebar"
import { ProjectItem } from "./ProjectItem"
import { cn } from "@/lib/utils"
import type { Project } from "../../../../shared/types/database"

interface AppSidebarProps {
  projects: Project[]
  selectedProjectId: string | null
  onSelectProject: (id: string | null) => void
  onAddProject: () => void
}

export function AppSidebar({
  projects,
  selectedProjectId,
  onSelectProject,
  onAddProject,
}: AppSidebarProps) {
  return (
    <Sidebar collapsible="none" className="w-16 border-r">
      <SidebarContent className="py-4">
        <SidebarGroup>
          <SidebarGroupContent>
            <SidebarMenu className="flex flex-col items-center gap-2">
              {/* All projects button */}
              <SidebarMenuItem>
                <button
                  onClick={() => onSelectProject(null)}
                  className={cn(
                    "w-10 h-10 rounded-lg flex items-center justify-center",
                    "text-xs font-semibold bg-muted transition-all",
                    "hover:scale-105",
                    selectedProjectId === null && "ring-2 ring-primary ring-offset-2 ring-offset-background"
                  )}
                  title="All projects"
                >
                  All
                </button>
              </SidebarMenuItem>

              {/* Project blobs */}
              {projects.map((project) => (
                <SidebarMenuItem key={project.id}>
                  <ProjectItem
                    project={project}
                    selected={selectedProjectId === project.id}
                    onClick={() => onSelectProject(project.id)}
                  />
                </SidebarMenuItem>
              ))}

              {/* Add project button */}
              <SidebarMenuItem>
                <button
                  onClick={onAddProject}
                  className={cn(
                    "w-10 h-10 rounded-lg flex items-center justify-center",
                    "text-lg text-muted-foreground border-2 border-dashed",
                    "hover:border-primary hover:text-primary transition-colors"
                  )}
                  title="Add project"
                >
                  +
                </button>
              </SidebarMenuItem>
            </SidebarMenu>
          </SidebarGroupContent>
        </SidebarGroup>
      </SidebarContent>
    </Sidebar>
  )
}
```

Fixed width (w-16), non-collapsible. All button at top, projects in middle, add at bottom.
  </action>
  <verify>File exists with AppSidebar component using shadcn Sidebar.</verify>
  <done>AppSidebar component with All button and project blobs</done>
</task>

<task type="auto">
  <name>Task 3: Refactor App.tsx to use sidebar layout</name>
  <files>src/renderer/src/App.tsx</files>
  <action>
Update `src/renderer/src/App.tsx` to use SidebarProvider + AppSidebar:

1. Add imports:
```tsx
import { SidebarProvider, SidebarInset } from "@/components/ui/sidebar"
import { AppSidebar } from "@/components/sidebar/AppSidebar"
```

2. Remove the horizontal project tabs div (lines ~115-128)

3. Replace the outer div structure with:
```tsx
return (
  <SidebarProvider defaultOpen={true}>
    <AppSidebar
      projects={projects}
      selectedProjectId={selectedProjectId}
      onSelectProject={setSelectedProjectId}
      onAddProject={() => setProjectDialogOpen(true)}
    />
    <SidebarInset className="min-h-screen">
      <div className="p-6">
        <header className="mb-6 flex items-center justify-between">
          <h1 className="text-2xl font-bold">
            {selectedProjectId
              ? projects.find(p => p.id === selectedProjectId)?.name ?? 'Focus'
              : 'All Tasks'}
          </h1>
          <Button onClick={() => setCreateOpen(true)} disabled={projects.length === 0}>
            New Task
          </Button>
        </header>

        {projects.length === 0 ? (
          <div className="text-center text-muted-foreground">
            Click + in sidebar to create a project
          </div>
        ) : (
          <TaskList
            tasks={filteredTasks}
            onEdit={setEditingTask}
            onDelete={setDeletingTask}
          />
        )}

        {/* Dialogs remain unchanged */}
      </div>
    </SidebarInset>
  </SidebarProvider>
)
```

4. Update task filtering to support "All" view:
```tsx
const filteredTasks = selectedProjectId
  ? tasks.filter((t) => t.project_id === selectedProjectId)
  : tasks
```

5. Remove the "New Project" button from header (now handled by sidebar +)

6. Keep CreateProjectDialog but trigger from sidebar's onAddProject
  </action>
  <verify>`npm run dev` shows sidebar on left with All button, project blobs, + button. Click All shows all tasks. Click project filters to that project. Header shows project name or "All Tasks".</verify>
  <done>App.tsx uses sidebar layout with project selection</done>
</task>

</tasks>

<verification>
1. App shows sidebar on left (~64px wide)
2. "All" button at top of sidebar, clicking shows all tasks
3. Project blobs show 2-letter abbreviation on colored background
4. Selected project/All has ring indicator
5. + button opens create project dialog
6. Header shows "All Tasks" or project name based on selection
</verification>

<success_criteria>
- Sidebar visible with fixed width
- All button filters to all tasks
- Project blobs clickable for project filtering
- Selection indicator (ring) visible
- + button triggers project creation
- Layout matches SPEC sidebar design
</success_criteria>

<output>
After completion, create `.planning/phases/03-navigation/03-03-SUMMARY.md`
</output>
