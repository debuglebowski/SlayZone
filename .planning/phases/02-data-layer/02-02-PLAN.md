---
phase: 02-data-layer
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - package.json
  - src/renderer/src/lib/schemas.ts
  - src/renderer/src/components/ui/button.tsx
  - src/renderer/src/components/ui/input.tsx
  - src/renderer/src/components/ui/textarea.tsx
  - src/renderer/src/components/ui/select.tsx
  - src/renderer/src/components/ui/dialog.tsx
  - src/renderer/src/components/ui/form.tsx
  - src/renderer/src/components/ui/calendar.tsx
  - src/renderer/src/components/ui/popover.tsx
  - src/renderer/src/components/ui/alert-dialog.tsx
autonomous: true

must_haves:
  truths:
    - "shadcn Form components installed and importable"
    - "Zod schemas validate task and project data"
    - "Date picker works via Calendar + Popover"
    - "AlertDialog available for delete confirmations"
  artifacts:
    - path: "src/renderer/src/lib/schemas.ts"
      provides: "Zod validation schemas"
      exports: ["taskSchema", "projectSchema", "TaskFormData", "ProjectFormData"]
    - path: "src/renderer/src/components/ui/form.tsx"
      provides: "shadcn Form component"
      contains: "FormField"
    - path: "src/renderer/src/components/ui/dialog.tsx"
      provides: "Modal dialog component"
      contains: "DialogContent"
    - path: "src/renderer/src/components/ui/alert-dialog.tsx"
      provides: "Delete confirmation dialog"
      contains: "AlertDialogAction"
  key_links:
    - from: "src/renderer/src/lib/schemas.ts"
      to: "src/shared/types/database.ts"
      via: "TaskStatus type for enum validation"
      pattern: "z.enum.*inbox.*backlog"
---

<objective>
Install shadcn form components and create Zod validation schemas.

Purpose: Provide UI primitives and validation for CRUD forms.
Output: All shadcn components needed for task/project forms.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-data-layer/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and shadcn components</name>
  <files>
    - package.json
    - src/renderer/src/components/ui/*
  </files>
  <action>
    1. Install form validation dependencies:
       ```bash
       npm install react-hook-form zod @hookform/resolvers
       ```

    2. Install date handling:
       ```bash
       npm install date-fns
       ```

    3. Install shadcn components (run from project root):
       ```bash
       npx shadcn@latest add button input textarea select dialog form calendar popover alert-dialog
       ```
       Note: If prompted about existing files, overwrite them.
       Note: If prompted about dependencies, allow installation.

    4. Verify components exist in src/renderer/src/components/ui/:
       - button.tsx
       - input.tsx
       - textarea.tsx
       - select.tsx
       - dialog.tsx
       - form.tsx
       - calendar.tsx
       - popover.tsx
       - alert-dialog.tsx
       - label.tsx (dependency of form)
  </action>
  <verify>
    ls src/renderer/src/components/ui/
    Should show: button.tsx, dialog.tsx, form.tsx, calendar.tsx, popover.tsx, etc.

    npm run build (should succeed without errors)
  </verify>
  <done>All shadcn components installed</done>
</task>

<task type="auto">
  <name>Task 2: Create Zod validation schemas</name>
  <files>
    - src/renderer/src/lib/schemas.ts
  </files>
  <action>
    Create src/renderer/src/lib/schemas.ts:

    ```typescript
    import { z } from 'zod'

    // Task status enum matching database.ts
    export const taskStatusEnum = z.enum([
      'inbox',
      'backlog',
      'todo',
      'in_progress',
      'review',
      'done'
    ])

    // Priority 1-5
    export const priorityEnum = z.number().int().min(1).max(5)

    // Task creation schema
    export const createTaskSchema = z.object({
      projectId: z.string().uuid(),
      title: z.string().min(1, 'Title required').max(200, 'Title too long'),
      description: z.string().max(5000).optional(),
      status: taskStatusEnum.default('inbox'),
      priority: priorityEnum.default(3),
      dueDate: z.string().nullable().optional(), // ISO date string YYYY-MM-DD
    })

    // Task update schema (all optional except id)
    export const updateTaskSchema = z.object({
      id: z.string().uuid(),
      title: z.string().min(1).max(200).optional(),
      description: z.string().max(5000).nullable().optional(),
      status: taskStatusEnum.optional(),
      priority: priorityEnum.optional(),
      dueDate: z.string().nullable().optional(),
      blockedReason: z.string().max(500).nullable().optional(),
    })

    // Project creation schema
    export const createProjectSchema = z.object({
      name: z.string().min(1, 'Name required').max(100, 'Name too long'),
      color: z.string().regex(/^#[0-9a-fA-F]{6}$/, 'Invalid hex color'),
    })

    // Project update schema
    export const updateProjectSchema = z.object({
      id: z.string().uuid(),
      name: z.string().min(1).max(100).optional(),
      color: z.string().regex(/^#[0-9a-fA-F]{6}$/).optional(),
    })

    // Inferred types for forms
    export type CreateTaskFormData = z.infer<typeof createTaskSchema>
    export type UpdateTaskFormData = z.infer<typeof updateTaskSchema>
    export type CreateProjectFormData = z.infer<typeof createProjectSchema>
    export type UpdateProjectFormData = z.infer<typeof updateProjectSchema>

    // Status options for Select
    export const statusOptions = [
      { value: 'inbox', label: 'Inbox' },
      { value: 'backlog', label: 'Backlog' },
      { value: 'todo', label: 'Todo' },
      { value: 'in_progress', label: 'In Progress' },
      { value: 'review', label: 'Review' },
      { value: 'done', label: 'Done' },
    ] as const

    // Priority options for Select
    export const priorityOptions = [
      { value: 1, label: 'P1 - Urgent' },
      { value: 2, label: 'P2 - High' },
      { value: 3, label: 'P3 - Medium' },
      { value: 4, label: 'P4 - Low' },
      { value: 5, label: 'P5 - Someday' },
    ] as const
    ```
  </action>
  <verify>
    npm run build
    Should compile without errors.

    In code, can import:
    import { createTaskSchema, statusOptions } from '@/lib/schemas'
  </verify>
  <done>Zod schemas created with TypeScript types exported</done>
</task>

<task type="auto">
  <name>Task 3: Verify component imports work</name>
  <files>
    - src/renderer/src/App.tsx (temporary test)
  </files>
  <action>
    Temporarily add test imports to App.tsx to verify everything works:

    ```typescript
    // Test imports - remove after verification
    import { Button } from '@/components/ui/button'
    import { Input } from '@/components/ui/input'
    import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'
    import { Form, FormField, FormItem, FormLabel, FormControl, FormMessage } from '@/components/ui/form'
    import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'
    import { Calendar } from '@/components/ui/calendar'
    import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'
    import { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent } from '@/components/ui/alert-dialog'
    import { useForm } from 'react-hook-form'
    import { zodResolver } from '@hookform/resolvers/zod'
    import { createTaskSchema, statusOptions, priorityOptions } from '@/lib/schemas'
    ```

    Run: npm run dev
    Check for any import errors in console.

    After verification succeeds, remove the test imports from App.tsx.
  </action>
  <verify>
    npm run dev
    - No import errors
    - App loads normally
    - Console shows no missing module errors
  </verify>
  <done>All component imports verified working</done>
</task>

</tasks>

<verification>
1. npm ls react-hook-form zod @hookform/resolvers date-fns (all installed)
2. ls src/renderer/src/components/ui/ shows all component files
3. src/renderer/src/lib/schemas.ts exports schemas and types
4. npm run build succeeds
</verification>

<success_criteria>
- react-hook-form, zod, @hookform/resolvers, date-fns installed
- All shadcn components in components/ui/
- Zod schemas defined for task and project CRUD
- TypeScript compiles cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/02-data-layer/02-02-SUMMARY.md`
</output>
